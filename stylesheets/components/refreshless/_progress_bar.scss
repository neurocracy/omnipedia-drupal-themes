// -----------------------------------------------------------------------------
//   RefreshLess progress bar component partial
// -----------------------------------------------------------------------------

@use '../../variables/colours'; // Configure colours.
@use 'material.common/material.colour' as material-colour;
@use 'sass:color';
@use 'sass/helpers/colour';

:root,
// Double attribute for specificity to fix a brief flash of the Gin accent
// colour when navigating away from a page that triggers the progress bar to
// display.
:root[data-gin-accent][data-gin-accent] {

  --refreshless-progress-bar-colour: #{color.scale(
    material-colour.$primary, $lightness: 35%, $saturation: 90%,
  )};

  --refreshless-progress-bar-empty-colour: #{color.scale(
    color.mix(material-colour.$primary, colour.$background-light, 30%),
    $lightness: 25%,
  )};

  @include colour.on-dark-scheme {

    --refreshless-progress-bar-colour: #{color.scale(
      material-colour.$primary, $lightness: 25%, $saturation: 80%,
    )};

    --refreshless-progress-bar-empty-colour: #{color.mix(
      material-colour.$primary, colour.$background-dark, 60%,
    )};

  }

  // Redefine this as applying to background-size instead of width.
  --refreshless-progress-bar-value-transition: background-size var(
    --refreshless-progress-bar-transition-duration
  ) ease-out;

}

// This creates a bar in the empty area that the progress bar hasn't yet filled
// to give it better visibility and contrast compared to the default width
// animation.
.refreshless-document-progress-bar {

  width: 100%;

  background-color: var(--refreshless-progress-bar-empty-colour);

  background-image: linear-gradient(
    var(--refreshless-progress-bar-colour),
    var(--refreshless-progress-bar-colour),
  );

  background-size: var(--refreshless-progress-bar-computed-value) 100%;

  background-repeat: no-repeat;

  will-change: background-size;

}
